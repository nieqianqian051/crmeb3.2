(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1da3c429"],{"1b8f":function(t,e,a){"use strict";a.r(e);var i=a("2f62"),n=a("b0e7"),o=a("7998"),r=a("c4ad");function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){u(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function u(t,e,a){return(e=function(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var m={name:"create",components:{uploadPictures:n.a,goodsList:r.default},data:function(){return{currentTab:"1",modals:!1,headeNum:[{type:"1",name:"基础设置"},{type:"2",name:"关联商品"}],topicList:[],formValidate:{content_type:1,title:"",content:"",slider_image:[],video_url:"",image:"",topic_name:[],product_id:[]},imageList:[],ruleValidate:{content:[{required:!0,message:"请输入内容简介",trigger:"blur"}],slider_image:[{required:!0,message:"请上传图片",type:"array",trigger:"change"}],video_url:[{required:!0,message:"请上传视频",validator:function(t,e,a){if(!e)return a(new Error("请上传视频"));a()},trigger:"change"}],image:[{required:!0,validator:function(t,e,a){if(!e)return a(new Error("请上传视频封面图"));a()},trigger:"change"}]},columns:[{type:"selection",width:60,align:"center"},{title:"商品信息",slot:"info",minWidth:300},{title:"售价",key:"price",minWidth:180},{title:"库存",key:"stock",minWidth:180},{title:"操作",slot:"action",fixed:"right",width:100}],tableData:[],id:0,formSelection:[],typeTit:""}},computed:l(l({},Object(i.e)("admin/layout",["isMobile","menuCollapse"])),{},{labelWidth:function(){return this.isMobile?void 0:90},labelPosition:function(){return this.isMobile?"top":"right"}}),created:function(){this.allTopicList(),this.id=this.$route.params.id||0,this.id&&this.getInfo()},methods:{topicSelect:function(t){t.length>5&&(this.$Message.warning("最多只能选五层！"),t.pop())},allTopicList:function(){var t=this;Object(o.a)().then((function(e){t.topicList=e.data})).catch((function(e){t.$Message.error(e.msg)}))},delVideo:function(){this.$set(this.formValidate,"video_url",""),this.$refs.formValidate.validateField("video_url")},del:function(t){var e=this;this.tableData.forEach((function(a,i){if(t.id===a.id)return e.tableData.splice(i,1)})),this.formSelection=[]},batchDel:function(){for(var t=0;t<this.formSelection.length;t++)for(var e=0;e<this.tableData.length;e++)this.tableData[e].id===this.formSelection[t].id&&(this.tableData.splice(e,1),e--);this.formSelection=[]},selectChange:function(t){this.formSelection=t},addGoods:function(){this.modals=!0},cancel:function(){this.modals=!1},getProductId:function(t){this.modals=!1;var e=this.tableData.concat(t);this.tableData=this.unique(e,"id")},getInfo:function(){var t=this;Object(o.h)(this.id).then((function(e){t.formValidate=e.data,t.tableData=e.data.product})).catch((function(e){t.$Message.error(e.msg)}))},upTab:function(){this.currentTab="1"},downTab:function(t){var e=this;this.$refs[t].validate((function(t){t?e.currentTab="2":e.$Message.warning("请完善数据")}))},handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){if(t){var a=[];e.tableData&&e.tableData.length&&e.tableData.forEach((function(t){a.push(t.id)})),e.formValidate.product_id=a,1==e.formValidate.content_type&&(e.formValidate.image=e.formValidate.slider_image[0]),Object(o.k)(e.formValidate,e.id).then((function(t){e.$router.push({path:"/admin/content/community/content"}),e.$Message.success(t.msg)})).catch((function(t){e.$Message.error(t.msg)}))}else e.$Message.warning("请完善数据")}))},modalPicTap:function(t){var e=this;this.$imgModal((function(a){var i=a[0].att_dir;if("image"==t){if(i.includes("mp4"))return e.$Message.error("请选择正确的图片文件");e.formValidate.image=i}else{if(!i.includes("mp4"))return e.$Message.error("请选择正确的视频文件");e.formValidate.video_url=i}}))},addSlider:function(){var t=this;this.$imgModal((function(e){e.forEach((function(e){t.formValidate.slider_image.push(e.att_dir),t.formValidate.slider_image=t.formValidate.slider_image.splice(0,9)}))}))},unique:function(t,e){var a=new Map;return t.filter((function(t){return!a.has(t[e])&&a.set(t[e],1)}))},getPicD:function(t){var e=this;this.imageList=this.imageList.concat(t),this.unique(this.imageList,"att_id").map((function(t){e.formValidate.slider_image.push(t.att_dir)})),this.modalPic=!1},handleRemove:function(){this.formValidate.image="",this.$refs.formValidate.validateField("image")},handleRemove2:function(t){this.formValidate.slider_image.splice(t,1)}}},d=(a("b6d2"),a("2877")),f=Object(d.a)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"i-layout-page-header"},[a("PageHeader",{staticClass:"product_tabs",attrs:{"hidden-breadcrumb":""}},[a("div",{staticClass:"acea-row row-middle",attrs:{slot:"title"},slot:"title"},[a("router-link",{attrs:{to:{path:"/admin/content/community/content"}}},[a("div",{staticClass:"font-sm after-line"},[a("span",{staticClass:"iconfont iconfanhui"}),a("span",{staticClass:"pl10"},[t._v("返回")])])]),a("span",{staticClass:"mr20 ml16",domProps:{textContent:t._s(t.$route.params.id?"编辑内容":"添加内容")}})],1)])],1),a("Card",{staticClass:"ivu-mt mb79",attrs:{bordered:!1,"dis-hover":""}},[a("div",{staticClass:"new_tab"},[a("Tabs",{model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},t._l(t.headeNum,(function(t,e){return a("TabPane",{key:e,attrs:{label:t.name,name:t.type}})})),1)],1),"2"===t.currentTab?a("div",{staticClass:"Button"},[a("Button",{staticClass:"bnt mr15",attrs:{type:"primary"},on:{click:t.addGoods}},[t._v("添加商品")]),a("Tooltip",{attrs:{content:"本页至少选中一项",disabled:!!t.formSelection.length}},[a("Button",{staticClass:"bnt mr15",attrs:{disabled:!t.formSelection.length},on:{click:t.batchDel}},[t._v("批量删除\n        ")])],1)],1):t._e(),a("Form",{ref:"formValidate",staticClass:"formValidate mt20",attrs:{rules:t.ruleValidate,model:t.formValidate,"label-width":t.labelWidth,"label-position":t.labelPosition},nativeOn:{submit:function(t){t.preventDefault()}}},[a("Row",{directives:[{name:"show",rawName:"v-show",value:"1"===t.currentTab,expression:"currentTab === '1'"}],attrs:{gutter:24,type:"flex"}},[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"内容类型：",prop:"content_type"}},[a("RadioGroup",{model:{value:t.formValidate.content_type,callback:function(e){t.$set(t.formValidate,"content_type",e)},expression:"formValidate.content_type"}},[a("Radio",{attrs:{label:1}},[t._v("图文")]),a("Radio",{attrs:{label:2}},[t._v("短视频")])],1)],1)],1),a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"内容标题："}},[a("Input",{directives:[{name:"width",rawName:"v-width",value:"50%",expression:"'50%'"}],attrs:{placeholder:"请输入内容标题",maxlength:"20","show-word-limit":""},model:{value:t.formValidate.title,callback:function(e){t.$set(t.formValidate,"title",e)},expression:"formValidate.title"}})],1)],1),a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"内容简介：",prop:"content"}},[a("Input",{directives:[{name:"width",rawName:"v-width",value:"50%",expression:"'50%'"}],attrs:{type:"textarea",rows:3,placeholder:"请输入内容简介",maxlength:"600","show-word-limit":""},model:{value:t.formValidate.content,callback:function(e){t.$set(t.formValidate,"content",e)},expression:"formValidate.content"}})],1)],1),1==t.formValidate.content_type?a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"上传图片：",prop:"slider_image"}},[a("div",{staticClass:"pictrueBox"},[t._l(t.formValidate.slider_image,(function(e,i){return a("div",{key:i,staticClass:"pictrue"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"item"}]}),a("Button",{staticClass:"btndel",attrs:{shape:"circle",icon:"md-close"},on:{click:function(e){return e.stopPropagation(),t.handleRemove2(i)}}})],1)})),t.formValidate.slider_image.length<9?a("div",{staticClass:"upLoad acea-row row-center-wrapper",on:{click:function(e){return t.addSlider()}}},[a("Input",{staticClass:"input-display",model:{value:t.formValidate.image,callback:function(e){t.$set(t.formValidate,"image",e)},expression:"formValidate.image"}}),a("Icon",{attrs:{type:"ios-add",size:"26"}})],1):t._e()],2),a("div",{staticClass:"tips"},[t._v("建议尺寸：226 * 300px")])])],1):t._e(),2==t.formValidate.content_type?a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"上传视频：",prop:"video_url"}},[a("Button",{on:{click:function(e){return t.modalPicTap("video")}}},[t._v("上传视频")]),a("div",{staticClass:"tips"},[t._v("\n              建议时长：9～30秒，视频宽高比9:16（不建议本地储存）\n            ")]),t.formValidate.video_url?a("div",{staticClass:"iview-video-style"},[a("video",{staticClass:"video-style",attrs:{src:t.formValidate.video_url,controls:"controls"}}),a("div",{staticClass:"mark"}),a("Icon",{staticClass:"iconv",attrs:{type:"ios-trash-outline"},on:{click:t.delVideo}})],1):t._e()],1)],1):t._e(),2==t.formValidate.content_type?a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"封面图：",prop:"image"}},[a("div",{staticClass:"pictrueBox"},[t.formValidate.image?a("div",{staticClass:"pictrue"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.formValidate.image,expression:"formValidate.image"}]}),a("Button",{staticClass:"btndel",attrs:{shape:"circle",icon:"md-close"},on:{click:function(e){return e.stopPropagation(),t.handleRemove(e)}}})],1):a("div",{staticClass:"upLoad acea-row row-center-wrapper",on:{click:function(e){return t.modalPicTap("image")}}},[a("Input",{staticClass:"input-display",model:{value:t.formValidate.image,callback:function(e){t.$set(t.formValidate,"image",e)},expression:"formValidate.image"}}),a("Icon",{attrs:{type:"ios-add",size:"26"}})],1)]),a("div",{staticClass:"tips"},[t._v("建议尺寸：226 * 300px")])])],1):t._e(),a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"添加话题："}},[a("Select",{directives:[{name:"width",rawName:"v-width",value:"50%",expression:"'50%'"}],attrs:{multiple:"",clearable:""},on:{"on-change":t.topicSelect},model:{value:t.formValidate.topic_name,callback:function(e){t.$set(t.formValidate,"topic_name",e)},expression:"formValidate.topic_name"}},t._l(t.topicList,(function(e,i){return a("Option",{key:i,attrs:{value:e.name}},[t._v(t._s(e.name)+"\n              ")])})),1)],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"2"===t.currentTab,expression:"currentTab === '2'"}]},[a("Table",{staticClass:"ivu-mt",attrs:{columns:t.columns,data:t.tableData,"highlight-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"},on:{"on-selection-change":t.selectChange},scopedSlots:t._u([{key:"info",fn:function(e){var i=e.row;return[a("div",{staticClass:"imgPic acea-row row-middle"},[a("viewer",[a("div",{staticClass:"pictrue"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i.image,expression:"row.image"}]})])]),a("div",{staticClass:"info"},[a("Tooltip",{attrs:{"max-width":"200",placement:"bottom",transfer:""}},[a("span",{staticClass:"line2"},[t._v(t._s(i.store_name)+t._s(i.suk))]),a("p",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(i.store_name)+t._s(i.suk))])])],1)],1)]}},{key:"action",fn:function(e){var i=e.row;return[a("a",{on:{click:function(e){return t.del(i)}}},[t._v("删除")])]}}])})],1)],1)],1),a("Card",{staticClass:"fixed-card",style:{left:t.menuCollapse?t.isMobile?"0":"80px":"200px"},attrs:{bordered:!1,"dis-hover":""}},[a("Form",[a("FormItem",["1"!==t.currentTab?a("Button",{staticStyle:{"margin-right":"10px"},on:{click:t.upTab}},[t._v("上一步\n        ")]):t._e(),"2"!==t.currentTab?a("Button",{staticClass:"submission",attrs:{type:"primary"},on:{click:function(e){return t.downTab("formValidate")}}},[t._v("下一步\n        ")]):a("Button",{staticClass:"submission",attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("保存\n        ")])],1)],1)],1),a("Modal",{staticClass:"paymentFooter",attrs:{title:"商品列表",footerHide:"",scrollable:"",width:"900"},on:{"on-cancel":t.cancel},model:{value:t.modals,callback:function(e){t.modals=e},expression:"modals"}},[t.modals?a("goods-list",{ref:"goodslist",attrs:{ischeckbox:!0,isdiy:!0},on:{getProductId:t.getProductId}}):t._e()],1)],1)}),[],!1,null,"5bfc94ec",null);e.default=f.exports},7998:function(t,e,a){"use strict";a.d(e,"o",(function(){return n})),a.d(e,"p",(function(){return o})),a.d(e,"q",(function(){return r})),a.d(e,"r",(function(){return s})),a.d(e,"a",(function(){return c})),a.d(e,"g",(function(){return l})),a.d(e,"i",(function(){return u})),a.d(e,"l",(function(){return m})),a.d(e,"m",(function(){return d})),a.d(e,"f",(function(){return f})),a.d(e,"e",(function(){return p})),a.d(e,"n",(function(){return h})),a.d(e,"k",(function(){return b})),a.d(e,"h",(function(){return v})),a.d(e,"b",(function(){return g})),a.d(e,"c",(function(){return y})),a.d(e,"d",(function(){return _})),a.d(e,"j",(function(){return w}));var i=a("b6bd");function n(t){return Object(i.a)({url:"community/topic/list",method:"get",params:t})}function o(t){return Object(i.a)({url:"community/topic/save_form/".concat(t),method:"get"})}function r(t){return Object(i.a)({url:"community/topic/set_hot/".concat(t.id,"/").concat(t.hot),method:"get"})}function s(t){return Object(i.a)({url:"/community/topic/set_status/".concat(t.id,"/").concat(t.status),method:"get"})}function c(){return Object(i.a)({url:"community/all_topic",method:"get"})}function l(t){return Object(i.a)({url:"community/community/header",method:"get",params:t})}function u(t){return Object(i.a)({url:"community/community/list",method:"get",params:t})}function m(t){return Object(i.a)({url:"community/community/star/form/".concat(t),method:"get"})}function d(t){return Object(i.a)({url:"community/community/set_status/".concat(t.id,"/").concat(t.status),method:"post"})}function f(t){return Object(i.a)({url:"community/community/take_down/form/".concat(t),method:"get"})}function p(t){return Object(i.a)({url:"community/comment/fictitious/".concat(t),method:"get"})}function h(t,e){return Object(i.a)({url:"community/community/set_verify/".concat(t),method:"post",data:e})}function b(t,e){return Object(i.a)({url:"community/community/save/".concat(e),method:"post",data:t})}function v(t){return Object(i.a)({url:"community/community/info/".concat(t),method:"get"})}function g(t){return Object(i.a)({url:"community/comment/list",method:"get",params:t})}function y(t){return Object(i.a)({url:"community/comment/reply/form/".concat(t),method:"get"})}function _(t,e){return Object(i.a)({url:"community/comment/set_verify/".concat(t),method:"post",data:e})}function w(t,e){return Object(i.a)({url:"community/comment/set_status/".concat(t,"/").concat(e),method:"put"})}},a620:function(t,e,a){},b6d2:function(t,e,a){"use strict";var i=a("a620");a.n(i).a}}]);